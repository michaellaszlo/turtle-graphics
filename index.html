<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<style type="text/css">
body {
  margin: 0;
  padding: 0;
}
canvas {
  width: 100%;
  height: 100%;
}
.display {
  font-family: sans-serif;
  font-size: 24px;
  color: #444;
  position: fixed;
  left: 10px;
}
.label {
  color: #aaa;
}
#begin {
  bottom: 50px;
}
#end {
  bottom: 10px;
}
</style>
<script>
var Polygon = {};
Polygon.resize = function() {
  var g = Polygon,
      canvas = g.canvas;
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  console.log(canvas.width+' '+canvas.height);
};
Polygon.load = function () {
  var g = Polygon,
      canvas = g.canvas = document.getElementById('surface'),
      context = canvas.getContext('2d'),
      display = { begin: document.getElementById('begin'),
                  end: document.getElementById('end') };
  g.resize();
  window.onresize = g.resize;
  var getPosition = function (event) {
    event = event || window.event;
    var rect = canvas.getBoundingClientRect();
    return { x: event.clientX - rect.left, y: event.clientY - rect.top };
  };
  var x1, y1, x2, y2;
  canvas.onmousedown = function (event) {
    document.body.style.cursor = 'default';
    var position = getPosition(event);
    x1 = x2 = position.x;
    y1 = y2 = position.y;
    display.end.innerHTML = '';
    display.begin.innerHTML = '<span class="label">x1, y1 =</span> '+x1+', '+y1;
    context.lineWidth = 3;
    context.strokeStyle = '#e79393';
    canvas.onmousemove = function (event) {
      var position = getPosition(event);
      x2 = position.x;
      y2 = position.y;
      console.log(0, 0, canvas.width, canvas.height);
      context.clearRect(0, 0, canvas.width, canvas.height);
      context.beginPath();
      context.moveTo(x1, y1);
      context.lineTo(x2, y2);
      context.stroke();
    };
  };
  canvas.onmouseup = canvas.onmouseout = function (event) {
    console.log('out');
    canvas.onmousemove = undefined;
    canvas.onmouseout = undefined;
    var position = getPosition(event);
    display.end.innerHTML = '<span class="label">x2, y2 =</span> '+x2+', '+y2;
    context.strokeStyle = '#37387e';
    context.beginPath();
    context.moveTo(x1, y1);
    context.lineTo(x2, y2);
    context.stroke();
  };
};
window.onload = Polygon.load;
</script>
</head>
<body>

<canvas id="surface"></canvas>

<div class="display" id="begin"></div>

<div class="display" id="end"></div>

</body>
</html>
